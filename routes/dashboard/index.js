var router = require('express').Router();

// ---------------------------------------------------------------------------------------------------------------------
// Validate Permission
// ---------------------------------------------------------------------------------------------------------------------

router.use('/', function (req, res, next) {
    if (!req.isAuthenticated() || !req.user.admin) {
        if (req.xhr) {
            return next(401);
        } else {
            return res.redirect(req.urls.generate('/passport/admin/login', {
                redirect: req.originalUrl
            }));
        }
    }

    next();
});

// ---------------------------------------------------------------------------------------------------------------------
// Index
// ---------------------------------------------------------------------------------------------------------------------

router.get('/', function (req, res) {
    res.redirect(req.urls.generate('/dashboard/pages/explore'));
});

// ---------------------------------------------------------------------------------------------------------------------
// Export
// ---------------------------------------------------------------------------------------------------------------------

module.exports = router;